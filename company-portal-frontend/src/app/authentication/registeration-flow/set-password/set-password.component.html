<form [formGroup]="passwordForm" (ngSubmit)="completeRegistration()" class="needs-validation" novalidate>
  <!-- New Password -->
  <div class="mb-4">
    <label for="newPassword" class="form-label fw-semibold">
      New Password <span class="text-danger">*</span>
    </label>
    <div class="input-group">
      <input [type]="showNewPassword ? 'text' : 'password'" 
             class="form-control form-control-lg" 
             id="newPassword" 
             formControlName="newPassword"
             placeholder="Enter your password">
      <button class="btn btn-outline-secondary" type="button" (click)="showNewPassword = !showNewPassword">
        <!-- <i class="bi" [class.bi-eye]="!showNewPassword" [class.bi-eye-slash]="showNewPassword"></i> -->
           <i class="fas" [ngClass]="showNewPassword ? 'fa-eye-slash' : 'fa-eye'"></i>
      </button>
    </div>
    <div class="invalid-feedback d-block" 
         *ngIf="passwordForm.controls['newPassword'].touched && passwordForm.controls['newPassword'].invalid">
      <i class="fas fa-exclamation-circle me-1 text-danger"></i>
      <span *ngIf="passwordForm.controls['newPassword'].hasError('required')">Password is required</span>
      <span *ngIf="passwordForm.controls['newPassword'].hasError('minlength')">
        Password must be at least 6 characters
      </span>
    </div>
    <div class="form-text">Must be at least 6 characters long</div>
  </div>

  <!-- Confirm Password -->
  <div class="mb-4">
    <label for="confirmPassword" class="form-label fw-semibold">
      Confirm Password <span class="text-danger">*</span>
    </label>
    <div class="input-group">
      <input [type]="showConfirmPassword ? 'text' : 'password'" 
             class="form-control form-control-lg" 
             id="confirmPassword" 
             formControlName="confirmPassword"
             placeholder="Confirm your password">
      <button class="btn btn-outline-secondary" type="button" (click)="showConfirmPassword = !showConfirmPassword">
        <i class="fas" [ngClass]="showConfirmPassword ? 'fa-eye-slash' : 'fa-eye'"></i>

      </button>
    </div>
    <div class="invalid-feedback d-block" 
         *ngIf="passwordForm.controls['confirmPassword'].touched && passwordForm.controls['confirmPassword'].invalid">
      <i class="fas fa-exclamation-circle me-1 text-danger"></i>
      <span *ngIf="passwordForm.controls['confirmPassword'].hasError('required')">Please confirm your password</span>
    </div>
    <div class="invalid-feedback d-block" 
         *ngIf="passwordForm.hasError('mismatch') && passwordForm.controls['confirmPassword'].touched">
      <i class="fas fa-exclamation-circle me-1 text-danger"></i>
      Passwords do not match
    </div>
  </div>

  <!-- Password Strength Meter -->
  <div class="mb-4">
    <div class="password-strength-meter">
      <div class="strength-section" [class.active]="passwordForm.controls['newPassword'].value?.length >= 1"></div>
      <div class="strength-section" [class.active]="passwordForm.controls['newPassword'].value?.length >= 3"></div>
      <div class="strength-section" [class.active]="passwordForm.controls['newPassword'].value?.length >= 6"></div>
      <div class="strength-section" [class.active]="passwordForm.controls['newPassword'].value?.length >= 8"></div>
    </div>
    <div class="form-text text-end" [class]="getPasswordStrengthClass()">
      <span>{{getPasswordStrength()}}</span>
    </div>
  </div>

  <!-- Submit Button -->
  <div class="d-grid mt-4">
    <button type="submit" class="btn btn-primary btn-lg" [disabled]="passwordForm.invalid || isLoading">
      <span *ngIf="!isLoading">Complete Registration</span>
      <span *ngIf="isLoading">
        <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
        Creating Account...
      </span>
    </button>
  </div>
</form>